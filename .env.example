# ============================================
# Environment Configuration
# ============================================
# Copy this file to .env and update with your values
# Use setup-env.ps1 (Windows) or setup-env.sh (Linux/Mac) for automatic setup

# ============================================
# Volume Data Root Path
# ============================================
# All persistent data (MySQL, Redis, ClickHouse, logs, etc.) will be stored under this path
# Windows: ./data/gatrix-storage-root (relative path)
# Linux: /data/gatrix-storage-root (absolute path, as required by infrastructure)
DATA_ROOT=./data/gatrix-storage-root

# Database Configuration
DB_HOST=mysql
DB_PORT=3306
DB_NAME=gatrix
DB_USER=gatrix_user
DB_PASSWORD=gatrix_password
DB_ROOT_PASSWORD=gatrix_rootpassword

# Redis Configuration
# For Docker: use internal port 6379 (not the host-mapped port)
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=

# Host Port Mappings (ports exposed to host machine)
# These are in the 50000 range to avoid conflicts with other services
MYSQL_HOST_PORT=53306
REDIS_HOST_PORT=56379

# JWT Configuration
JWT_SECRET=change-this-to-a-very-secure-random-string-min-32-chars
JWT_REFRESH_SECRET=change-this-to-another-secure-random-string-min-32-chars
JWT_EXPIRES_IN=7d

# Session Configuration
SESSION_SECRET=change-this-to-a-secure-session-secret-min-32-chars
SESSION_MAX_AGE=86400000
SESSION_TTL=86400

# OAuth Configuration (Update with your actual credentials)
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret

GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret

# Server Configuration
PORT=55000
NODE_ENV=production

# CORS Configuration - Allow localhost and IP-based access for development
# In production, update with your actual domain: https://yourdomain.com
CORS_ORIGIN=http://localhost:53000,http://10.10.30.84:53000

# Frontend URL - Update with your actual domain
FRONTEND_URL=http://localhost:53000

# Frontend Port Configuration
FRONTEND_PORT=53000
FRONTEND_HTTPS_PORT=53443

# Admin Configuration
ADMIN_EMAIL=admin@gatrix.com
ADMIN_PASSWORD=admin123
ADMIN_NAME=Administrator

# Logging
LOG_LEVEL=info
LOG_DIR=logs

# Chat Server Configuration
CHAT_SERVER_URL=http://chat-server:5100

# Service Discovery
SERVICE_DISCOVERY_MODE=etcd
SERVICE_DISCOVERY_HEARTBEAT_TTL=30
SERVICE_DISCOVERY_INACTIVE_KEEP_TTL=60
SERVICE_DISCOVERY_TERMINATED_MARKER_TTL=300
ETCD_HOSTS=http://etcd:52379

# Frontend Configuration
VITE_API_URL=/api/v1
VITE_APP_NAME=Gatrix
VITE_DEFAULT_LANGUAGE=zh
VITE_ROUTER_BASENAME=/

VITE_GRAFANA_URL=http://localhost:54000
VITE_BULL_BOARD_URL=http://localhost:53000/bull-board
VITE_EDGE_URL=http://localhost:1400

# Chat Database Configuration
CHAT_DB_NAME=gatrix_chat
CHAT_DB_HOST=mysql
CHAT_DB_PORT=3306
CHAT_DB_USER=gatrix_user
CHAT_DB_PASSWORD=gatrix_password

# Event Lens Configuration
CLICKHOUSE_HOST=clickhouse
CLICKHOUSE_PORT=8123
CLICKHOUSE_DATABASE=event_lens
CLICKHOUSE_USERNAME=default
CLICKHOUSE_PASSWORD=

# Host Port Mappings for Services
BACKEND_PORT=45000
CHAT_PORT=45100
EVENT_LENS_PORT=45200
LOKI_PORT=43100
PROMETHEUS_PORT=49090
GRAFANA_PORT=44000
# ETCD ports changed to 4xxxx range to avoid Windows reserved port conflicts
ETCD_PORT=42379
CLICKHOUSE_HTTP_PORT=48123
CLICKHOUSE_NATIVE_PORT=49000

# Event Lens Worker Configuration
WORKER_BATCH_SIZE=1000
WORKER_BATCH_TIMEOUT=5000
WORKER_CONCURRENCY=10

# Chat Server Configuration
CHAT_CLUSTER_ENABLED=true
CHAT_CLUSTER_WORKERS=0
CHAT_STICKY_SESSION=true
CHAT_BROADCAST_BATCH_SIZE=1000
CHAT_USE_MESSAGE_PACK=true
CHAT_BROADCAST_COMPRESSION=true
CHAT_WS_MAX_CONNECTIONS=10000
CHAT_MONITORING_ENABLED=true

# Gatrix Integration
GATRIX_API_URL=http://backend:55000
GATRIX_API_SECRET=change-this-to-secure-shared-secret

# Logging Levels
CHAT_LOG_LEVEL=info
EVENT_LENS_LOG_LEVEL=info
EDGE_LOG_LEVEL=info

# Disable X-Powered-By header for security
DISABLE_X_POWERED_BY=true

# Default Language
DEFAULT_LANGUAGE=zh

# ============================================
# Edge Server Configuration
# ============================================
# Edge server provides high-availability client-facing APIs
# It caches data from backend and serves clients even when backend is down

# Edge server port (exposed to host)
EDGE_PORT=51337

# API token for Edge server to authenticate with backend
EDGE_API_TOKEN=gatrix-unsecured-server-api-token

# Application name for Edge server
EDGE_APPLICATION_NAME=edge-server

# Target environments (comma-separated)
# Edge server will cache data for these environments
# Example: env_prod,env_staging,env_dev
EDGE_ENVIRONMENTS=

# Cache synchronization method: polling, event, or manual
# - polling: Periodically fetch data from backend (default)
# - event: Real-time updates via Redis PubSub
# - manual: Only refresh when explicitly triggered
EDGE_CACHE_SYNC_METHOD=polling

# Cache polling interval in milliseconds (only used when EDGE_CACHE_SYNC_METHOD=polling)
EDGE_CACHE_POLLING_INTERVAL_MS=60000
