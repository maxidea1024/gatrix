"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[8411],{3740(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var i=t(5126),o=t(4848),r=t(8453);const s={slug:"production-deployment-tips",title:"Gatrix Production Deployment Tips and Best Practices",authors:["gatrix-team"],tags:["gatrix","tips","deployment","production"]},a=void 0,l={authorsImageUrls:[void 0]},c=[{value:"Pre-deployment Checklist",id:"pre-deployment-checklist",level:2},{value:"1. Environment Configuration",id:"1-environment-configuration",level:3},{value:"2. Security Configuration",id:"2-security-configuration",level:3},{value:"Docker Optimization",id:"docker-optimization",level:2},{value:"Multi-stage Build",id:"multi-stage-build",level:3},{value:"Monitoring Setup",id:"monitoring-setup",level:2},{value:"Prometheus Metrics",id:"prometheus-metrics",level:3},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"Essential tips and best practices for deploying Gatrix safely and efficiently to production environments."}),"\n",(0,o.jsx)(n.h2,{id:"pre-deployment-checklist",children:"Pre-deployment Checklist"}),"\n",(0,o.jsx)(n.h3,{id:"1-environment-configuration",children:"1. Environment Configuration"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'# Verify required environment variables\necho "=== Environment Check ==="\necho "NODE_ENV: $NODE_ENV"\necho "DB_HOST: $DB_HOST"\necho "REDIS_HOST: $REDIS_HOST"\necho "JWT_SECRET: ${JWT_SECRET:0:10}..."\n\n# Database connection test\nnpm run test:db-connection\n\n# Redis connection test\nnpm run test:redis-connection\n'})}),"\n",(0,o.jsx)(n.h3,{id:"2-security-configuration",children:"2. Security Configuration"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:"// Security middleware setup\nconst helmet = require('helmet');\nconst rateLimit = require('express-rate-limit');\n\napp.use(\n  helmet({\n    contentSecurityPolicy: {\n      directives: {\n        defaultSrc: [\"'self'\"],\n        styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n        scriptSrc: [\"'self'\"],\n        imgSrc: [\"'self'\", 'data:', 'https:'],\n      },\n    },\n    hsts: {\n      maxAge: 31536000,\n      includeSubDomains: true,\n      preload: true,\n    },\n  })\n);\n\n// Rate Limiting\nconst limiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 100,\n  message: 'Too many requests. Please try again later.',\n  standardHeaders: true,\n  legacyHeaders: false,\n});\n\napp.use('/api/', limiter);\n"})}),"\n",(0,o.jsx)(n.h2,{id:"docker-optimization",children:"Docker Optimization"}),"\n",(0,o.jsx)(n.h3,{id:"multi-stage-build",children:"Multi-stage Build"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-dockerfile",children:'# Dockerfile\nFROM node:22-alpine AS builder\n\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci --only=production && npm cache clean --force\n\nCOPY . .\nRUN npm run build\n\n# Production image\nFROM node:22-alpine AS production\n\n# Create non-root user for security\nRUN addgroup -g 1001 -S nodejs\nRUN adduser -S gatrix -u 1001\n\nWORKDIR /app\n\nCOPY --from=builder --chown=gatrix:nodejs /app/dist ./dist\nCOPY --from=builder --chown=gatrix:nodejs /app/node_modules ./node_modules\nCOPY --from=builder --chown=gatrix:nodejs /app/package*.json ./\n\nUSER gatrix\n\nEXPOSE 3000 5000 3001\n\nCMD ["node", "dist/index.js"]\n'})}),"\n",(0,o.jsx)(n.h2,{id:"monitoring-setup",children:"Monitoring Setup"}),"\n",(0,o.jsx)(n.h3,{id:"prometheus-metrics",children:"Prometheus Metrics"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:"const prometheus = require('prom-client');\n\nconst register = new prometheus.Registry();\nprometheus.collectDefaultMetrics({ register });\n\nconst httpRequestDuration = new prometheus.Histogram({\n  name: 'http_request_duration_seconds',\n  help: 'Duration of HTTP requests in seconds',\n  labelNames: ['method', 'route', 'status_code'],\n  buckets: [0.1, 0.3, 0.5, 0.7, 1, 3, 5, 7, 10],\n});\n\nregister.registerMetric(httpRequestDuration);\n\nmodule.exports = { register, httpRequestDuration };\n"})}),"\n",(0,o.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,o.jsx)(n.p,{children:"Following this guide ensures:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Stability"}),": Monitoring and alerts for quick issue detection"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Security"}),": Multi-layer security protection"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Scalability"}),": Caching and optimization for performance"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Recovery"}),": Backup and restore for data protection"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},5126(e){e.exports=JSON.parse('{"permalink":"/docs/zh-Hans/blog/production-deployment-tips","editUrl":"https://github.com/your-org/gatrix/tree/main/docs/blog/2024-01-15-production-deployment-tips.md","source":"@site/blog/2024-01-15-production-deployment-tips.md","title":"Gatrix Production Deployment Tips and Best Practices","description":"Essential tips and best practices for deploying Gatrix safely and efficiently to production environments.","date":"2024-01-15T00:00:00.000Z","tags":[{"inline":false,"label":"Gatrix","permalink":"/docs/zh-Hans/blog/tags/gatrix","description":"Gatrix game platform management system"},{"inline":false,"label":"Tips","permalink":"/docs/zh-Hans/blog/tags/tips","description":"Tips and best practices"},{"inline":true,"label":"deployment","permalink":"/docs/zh-Hans/blog/tags/deployment"},{"inline":true,"label":"production","permalink":"/docs/zh-Hans/blog/tags/production"}],"readingTime":1.51,"hasTruncateMarker":true,"authors":[{"name":"Gatrix Team","title":"Game Platform Development Team","url":"https://github.com/your-org/gatrix","page":{"permalink":"/docs/zh-Hans/blog/authors/gatrix-team"},"socials":{"github":"https://github.com/your-org","email":"mailto:support@gatrix.com"},"imageURL":"https://avatars.githubusercontent.com/u/0?v=4","key":"gatrix-team"}],"frontMatter":{"slug":"production-deployment-tips","title":"Gatrix Production Deployment Tips and Best Practices","authors":["gatrix-team"],"tags":["gatrix","tips","deployment","production"]},"unlisted":false,"prevItem":{"title":"Gatrix Performance Optimization Guide","permalink":"/docs/zh-Hans/blog/performance-optimization"},"nextItem":{"title":"Gatrix API Integration and Webhook Setup Guide","permalink":"/docs/zh-Hans/blog/api-integration-webhooks"}}')},8453(e,n,t){t.d(n,{R:()=>s,x:()=>a});var i=t(6540);const o={},r=i.createContext(o);function s(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);